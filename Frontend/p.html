<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>UTM Timetable</title>
  <style>
    /* Original styles (completely unchanged) */
    body {
      margin: 0;
      font-family: 'Segoe UI', sans-serif;
      background-color: #f9f9f9;
    }

    header {
      background-color: #1e2a4a;
      color: white;
      padding: 15px 20px;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    header h1 {
      font-size: 20px;
      margin: 0;
    }

    .nav-tabs {
      display: flex;
      background: #fff;
      padding: 10px 20px;
      border-bottom: 1px solid #ccc;
    }

    .nav-tabs a {
      margin-right: 20px;
      text-decoration: none;
      font-weight: bold;
      color: #333;
    }

    .nav-tabs a.active {
      color: #7f1d1d;
      border-bottom: 3px solid #7f1d1d;
      padding-bottom: 5px;
    }

    .search-bar {
      margin: 10px 20px;
      max-width: 500px;
    }

    .search-bar input {
      width: 100%;
      padding: 10px;
      border-radius: 8px;
      border: 1px solid #ccc;
    }

    .section-title {
      margin: 20px;
      font-weight: bold;
    }

    .updates {
      margin: 20px;
      max-width: 600px;
    }

    .update {
      padding: 10px 0;
      border-top: 1px dotted #aaa;
    }

    .update span {
      font-weight: bold;
      color: #7f1d1d;
      margin-right: 5px;
    }

    .dashboard-container {
      display: flex;
      flex-wrap: wrap;
    }

    .left-section {
      flex: 1;
      min-width: 300px;
    }

    .right-section {
      flex: 1;
      min-width: 300px;
    }

    @media (max-width: 768px) {
      .dashboard-container {
        flex-direction: column;
      }
    }

    /* New sidebar styles (right side) */
    .menu-icon {
      font-size: 24px;
      cursor: pointer;
      color: white;
    }

    .sidebar {
      height: 100%;
      width: 0;
      position: fixed;
      z-index: 1000;
      top: 0;
      right: 0;
      background-color: #1e2a4a;
      overflow-x: hidden;
      transition: 0.3s;
      padding-top: 60px;
    }

    .sidebar-profile {
      text-align: center;
      padding: 20px;
      color: white;
      border-bottom: 1px solid #2c3a5a;
    }

    .profile-pic {
      width: 80px;
      height: 80px;
      border-radius: 50%;
      object-fit: cover;
      margin-bottom: 15px;
      border: 3px solid #7f1d1d;
    }

    .sidebar-menu {
      padding: 20px 0;
    }

    .sidebar-menu a {
      padding: 12px 20px;
      text-decoration: none;
      font-size: 16px;
      color: white;
      display: block;
      transition: 0.2s;
    }

    .sidebar-menu a:hover {
      background-color: #2c3a5a;
    }

    .close-btn {
      position: absolute;
      top: 15px;
      left: 25px;
      font-size: 20px;
      color: white;
      cursor: pointer;
    }

    /* New timetable styles from wireframe */
    .week-selector {
      display: flex;
      gap: 10px;
      margin: 20px;
      flex-wrap: wrap;
    }

    .week-btn {
      padding: 8px 15px;
      background-color: #eee;
      border: 1px solid #ddd;
      border-radius: 20px;
      cursor: pointer;
      font-size: 14px;
    }

    .week-btn.active {
      background-color: #1e2a4a;
      color: white;
      border-color: #1e2a4a;
    }

    .current-week {
      margin: 20px;
      font-size: 18px;
      font-weight: bold;
      color: #1e2a4a;
    }

    /* Calendar grid styles from wireframe */
    .weekly-view {
      display: grid;
      grid-template-columns: 80px repeat(5, 1fr);
      gap: 1px;
      background: #e2e8f0;
      margin: 20px;
    }

    .time-slot, .day-header, .schedule-cell {
      background: white;
      padding: 12px 8px;
      min-height: 60px;
    }

    .day-header {
      font-weight: 600;
      text-align: center;
      background: #f8fafc;
      color: #475569;
    }

    .time-slot {
      font-size: 12px;
      color: #64748b;
      text-align: center;
      background: #f8fafc;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .schedule-cell {
      position: relative;
    }

    /* Schedule card styles from wireframe */
    .schedule-card {
      padding: 12px;
      border: 1px solid #e2e8f0;
      border-radius: 8px;
      background: white;
      cursor: pointer;
      transition: all 0.2s;
      border-left: 4px solid #3b82f6;
      margin-bottom: 5px;
      font-size: 14px;
    }

    .schedule-card:hover {
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    }

    .course-code {
      font-size: 12px;
      color: #3b82f6;
      font-weight: 600;
      margin-bottom: 5px;
    }

    .schedule-time {
      font-size: 12px;
      color: #64748b;
      margin-bottom: 5px;
    }

    .course-name {
      font-weight: 600;
      color: #1e293b;
      margin-bottom: 5px;
    }

    .course-detail {
      font-size: 12px;
      color: #64748b;
      margin-top: 3px;
    }

    /* Filter bar styles from wireframe */
    .filter-bar {
      display: flex;
      gap: 10px;
      margin: 20px;
      flex-wrap: wrap;
    }

    .filter-select {
      padding: 8px 12px;
      border-radius: 20px;
      border: 1px solid #ddd;
      background-color: white;
      cursor: pointer;
      min-width: 120px;
    }

    /* Color coding for courses */
    .course-math { border-left-color: #ef4444; }
    .course-physics { border-left-color: #10b981; }
    .course-chemistry { border-left-color: #f59e0b; }
    .course-biology { border-left-color: #8b5cf6; }
  </style>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css">
</head>
<body>

<!-- Header with nav tabs and menu icon -->
<header>
  <h1>Timetable</h1>
  <div class="menu-icon" id="menuToggle">â˜°</div>
</header>

<nav class="nav-tabs">
  <a href="StudentDashboard.html">Dashboard</a>
  <a href="#" class="active">Timetable</a>
</nav>

<!-- Sidebar (right side) -->
<div id="sidebar" class="sidebar">
  <a href="javascript:void(0)" class="close-btn" id="closeSidebar">&times;</a>
  <div class="sidebar-profile">
    <img src="https://via.placeholder.com/150" alt="Profile" class="profile-pic" id="profileImage">
    <h3 id="userName">Student Name</h3>
    <p id="userMatric">Matric: A12345678</p>
  </div>
  <div class="sidebar-menu">
    <a href="#"><i class="fas fa-user"></i> Profile</a>
    <a href="StudentDashboard.html"><i class="fas fa-tachometer-alt"></i> Dashboard</a>
    <a href="#"><i class="fas fa-cog"></i> Settings</a>
    <a href="#" id="logoutBtn"><i class="fas fa-sign-out-alt"></i> Logout</a>
  </div>
</div>

<!-- Current Week Display -->
<div class="current-week" id="currentWeek">
  Minggu ke-1, Februari 2024
</div>

<!-- Week Selector -->
<div class="week-selector" id="weekSelector">
  <div class="week-btn active" data-week="1">Minggu 1</div>
  <div class="week-btn" data-week="2">Minggu 2</div>
  <div class="week-btn" data-week="3">Minggu 3</div>
  <div class="week-btn" data-week="4">Minggu 4</div>
</div>

<!-- Filter Bar -->
<div class="filter-bar">
  <select class="filter-select" id="dayFilter">
    <option value="all">Semua Hari</option>
    <option value="monday">Senin</option>
    <option value="tuesday">Selasa</option>
    <option value="wednesday">Rabu</option>
    <option value="thursday">Kamis</option>
    <option value="friday">Jumat</option>
  </select>

  <select class="filter-select" id="timeFilter">
    <option value="all">Semua Waktu</option>
    <option value="morning">Pagi (08:00-11:00)</option>
    <option value="afternoon">Siang (12:00-15:00)</option>
    <option value="evening">Sore (16:00-19:00)</option>
  </select>

  <select class="filter-select" id="typeFilter">
    <option value="all">Semua Jenis</option>
    <option value="lecture">Kuliah</option>
    <option value="tutorial">Tutorial</option>
    <option value="lab">Praktikum</option>
  </select>

  <select class="filter-select" id="lecturerFilter">
    <option value="all">Semua Dosen</option>
    <option value="hong">HONG Jisoo</option>
    <option value="chwe">CHWE Vernon</option>
    <option value="jeon">JEON Wonwoo</option>
  </select>
</div>

<!-- Weekly Timetable Grid -->
<div class="weekly-view">
  <div class="time-slot"></div>
  <div class="day-header">SENIN</div>
  <div class="day-header">SELASA</div>
  <div class="day-header">RABU</div>
  <div class="day-header">KAMIS</div>
  <div class="day-header">JUMAT</div>

  <!-- Morning -->
  <div class="time-slot">08:00-11:00</div>
  <div class="schedule-cell" id="mon-morning"></div>
  <div class="schedule-cell" id="tue-morning"></div>
  <div class="schedule-cell" id="wed-morning"></div>
  <div class="schedule-cell" id="thu-morning"></div>
  <div class="schedule-cell" id="fri-morning"></div>

  <!-- Afternoon -->
  <div class="time-slot">12:00-15:00</div>
  <div class="schedule-cell" id="mon-afternoon"></div>
  <div class="schedule-cell" id="tue-afternoon"></div>
  <div class="schedule-cell" id="wed-afternoon"></div>
  <div class="schedule-cell" id="thu-afternoon"></div>
  <div class="schedule-cell" id="fri-afternoon"></div>

  <!-- Evening -->
  <div class="time-slot">16:00-19:00</div>
  <div class="schedule-cell" id="mon-evening"></div>
  <div class="schedule-cell" id="tue-evening"></div>
  <div class="schedule-cell" id="wed-evening"></div>
  <div class="schedule-cell" id="thu-evening"></div>
  <div class="schedule-cell" id="fri-evening"></div>
</div>

<script>
  // Sample timetable data by week
  const timetableData = [
    { 
      id: 1,
      title: 'ProdMNG 2021 EA', 
      course: 'SMO 201 EA', 
      lecturer: 'HONG Jisoo', 
      day: 'monday',
      time: 'morning',
      type: 'lecture',
      location: 'A201',
      credits: '3',
      startTime: '08:00',
      endTime: '10:00',
      colorClass: 'course-math',
      weeks: [1, 2, 3, 4]
    },
    { 
      id: 2,
      title: 'Spanish 2 OB', 
      course: 'LNG 215 OD', 
      lecturer: 'CHWE Vernon', 
      day: 'wednesday',
      time: 'morning',
      type: 'tutorial',
      location: 'B305',
      credits: '2',
      startTime: '09:00',
      endTime: '11:00',
      colorClass: 'course-physics',
      weeks: [1, 3]
    },
    { 
      id: 3,
      title: 'Japanese Pre-advanced', 
      course: 'LNG 302 DC', 
      lecturer: 'JEON Wonwoo', 
      day: 'friday',
      time: 'afternoon',
      type: 'lecture',
      location: 'A201',
      credits: '3',
      startTime: '13:00',
      endTime: '15:00',
      colorClass: 'course-chemistry',
      weeks: [2, 4]
    },
    { 
      id: 4,
      title: 'Data Science Lab', 
      course: 'CS 301 EA', 
      lecturer: 'HONG Jisoo', 
      day: 'tuesday',
      time: 'evening',
      type: 'lab',
      location: 'Lab 3',
      credits: '4',
      startTime: '16:00',
      endTime: '19:00',
      colorClass: 'course-biology',
      weeks: [1, 2, 3, 4]
    }
  ];

  // Initialize timetable


    // Set user data in sidebar
    document.getElementById('userName').textContent = fullName;
    const matricNo = sessionStorage.getItem("matric_no") || "A12345678";
    const userType = sessionStorage.getItem("user_type") || "student";
    document.getElementById('userMatric').textContent = 
      userType === 'lecturer' ? `Staff ID: ${matricNo}` : `Matric: ${matricNo}`;

    // Current week
    let currentWeek = 1;
    const monthNames = ["Januari", "Februari", "Maret", "April", "Mei", "Juni", 
                       "Juli", "Agustus", "September", "Oktober", "November", "Desember"];
    const currentMonth = new Date().getMonth();
    
    function updateWeekDisplay() {
      document.getElementById('currentWeek').textContent = 
        `Minggu ke-${currentWeek}, ${monthNames[currentMonth]} ${new Date().getFullYear()}`;
    }

    // Render timetable for selected week
    function renderTimetable(week) {
      currentWeek = week;
      updateWeekDisplay();
      
      // Clear all cells
      document.querySelectorAll('.schedule-cell').forEach(cell => {
        cell.innerHTML = '';
      });

      // Filter classes for selected week
      const weekClasses = timetableData.filter(classItem => 
        classItem.weeks.includes(week)
      );

      // Populate timetable
      weekClasses.forEach(classItem => {
        const cellId = `${classItem.day.substring(0, 3)}-${classItem.time}`;
        const cell = document.getElementById(cellId);
        if (cell) {
          const classElement = document.createElement('div');
          classElement.className = `schedule-card ${classItem.colorClass}`;
          classElement.innerHTML = `
            <div class="course-code">${classItem.course}</div>
            <div class="course-name">${classItem.title}</div>
            <div class="schedule-time">${classItem.startTime}-${classItem.endTime}</div>
            <div class="course-detail">${classItem.lecturer}</div>
            <div class="course-detail">${classItem.location}</div>
          `;
          cell.appendChild(classElement);
        }
      });
    }

    // Week selector functionality
    document.querySelectorAll('.week-btn').forEach(btn => {
      btn.addEventListener('click', function() {
        document.querySelectorAll('.week-btn').forEach(b => b.classList.remove('active'));
        this.classList.add('active');
        const week = parseInt(this.dataset.week);
        renderTimetable(week);
      });
    });

    // Filter functionality
    function applyFilters() {
      const dayFilter = document.getElementById('dayFilter').value;
      const timeFilter = document.getElementById('timeFilter').value;
      const typeFilter = document.getElementById('typeFilter').value;
      const lecturerFilter = document.getElementById('lecturerFilter').value;

      // Hide/show rows based on time filter
      const timeSlots = document.querySelectorAll('.time-slot');
      timeSlots.forEach(slot => {
        if (slot.textContent && slot.textContent.trim() !== '') {
          const timeRow = slot.nextElementSibling;
          while (timeRow && !timeRow.classList.contains('time-slot')) {
            if (timeFilter === 'morning' && !slot.textContent.includes('08:00')) {
              timeRow.style.display = 'none';
            } else if (timeFilter === 'afternoon' && !slot.textContent.includes('12:00')) {
              timeRow.style.display = 'none';
            } else if (timeFilter === 'evening' && !slot.textContent.includes('16:00')) {
              timeRow.style.display = 'none';
            } else if (timeFilter === 'all') {
              timeRow.style.display = '';
            }
            timeRow = timeRow.nextElementSibling;
          }
        }
      });

      // Hide/show columns based on day filter
      const dayHeaders = document.querySelectorAll('.day-header');
      dayHeaders.forEach(header => {
        const day = header.textContent.trim().toLowerCase();
        const dayMatch = 
          (day.includes('senin') && dayFilter === 'monday') ||
          (day.includes('selasa') && dayFilter === 'tuesday') ||
          (day.includes('rabu') && dayFilter === 'wednesday') ||
          (day.includes('kamis') && dayFilter === 'thursday') ||
          (day.includes('jumat') && dayFilter === 'friday');
        
        if (dayFilter !== 'all' && !dayMatch) {
          // Hide column
          const colIndex = Array.from(header.parentNode.children).indexOf(header);
          document.querySelectorAll('.weekly-view > div').forEach(row => {
            if (row.parentNode.children[colIndex] === row) {
              row.style.display = 'none';
            }
          });
        } else {
          // Show column
          const colIndex = Array.from(header.parentNode.children).indexOf(header);
          document.querySelectorAll('.weekly-view > div').forEach(row => {
            if (row.parentNode.children[colIndex] === row) {
              row.style.display = '';
            }
          });
        }
      });

      // Highlight matching class types and lecturers
      document.querySelectorAll('.schedule-card').forEach(card => {
        const cardType = card.textContent.includes('Kuliah') ? 'lecture' : 
                        card.textContent.includes('Tutorial') ? 'tutorial' : 'lab';
        const cardLecturer = card.textContent.includes('HONG') ? 'hong' :
                           card.textContent.includes('CHWE') ? 'chwe' : 'jeon';
        
        const typeMatch = typeFilter === 'all' || cardType === typeFilter;
        const lecturerMatch = lecturerFilter === 'all' || cardLecturer === lecturerFilter;
        
        if (!typeMatch || !lecturerMatch) {
          card.style.opacity = '0.5';
        } else {
          card.style.opacity = '1';
        }
      });
    }

    // Initialize filters
    document.querySelectorAll('.filter-select').forEach(select => {
      select.addEventListener('change', applyFilters);
    });

    // Initial render
    renderTimetable(1);

    // Sidebar functionality (right side)
    document.getElementById('menuToggle').addEventListener('click', function() {
      document.getElementById('sidebar').style.width = '250px';
    });

    document.getElementById('closeSidebar').addEventListener('click', function() {
      document.getElementById('sidebar').style.width = '0';
    });

    document.getElementById('logoutBtn').addEventListener('click', function(e) {
      e.preventDefault();
      sessionStorage.clear();
      window.location.href = "loginPage.html";
    });

    // Close sidebar when clicking outside
    document.addEventListener('click', function(e) {
      if (!document.getElementById('sidebar').contains(e.target) && 
          e.target !== document.getElementById('menuToggle')) {
        document.getElementById('sidebar').style.width = '0';
      }
    });
</script>
</body>
</html>